{
  "metadata": {
    "timestamp": "2025-09-12T19:21:21.709018Z",
    "version": "2.0",
    "generatedBy": "AKS Network Diagnostics Script (Python)"
  },
  "cluster": {
    "name": "aks-api-connection",
    "resourceGroup": "aks-api-connection-lab1-rg",
    "subscription": "18fcfcaf-51b0-42c1-91ba-b14fe22f59dd",
    "provisioningState": "Failed",
    "location": "canadacentral",
    "nodeResourceGroup": "MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral",
    "networkProfile": {
      "advancedNetworking": null,
      "dnsServiceIp": "10.0.0.10",
      "ipFamilies": [
        "IPv4"
      ],
      "kubeProxyConfig": null,
      "loadBalancerProfile": {
        "allocatedOutboundPorts": null,
        "backendPoolType": "nodeIPConfiguration",
        "clusterServiceLoadBalancerHealthProbeMode": null,
        "effectiveOutboundIPs": [
          {
            "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral/providers/Microsoft.Network/publicIPAddresses/d88d92b8-c7c3-4237-b2b3-0269ab707dc4",
            "resourceGroup": "MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral"
          }
        ],
        "enableMultipleStandardLoadBalancers": null,
        "idleTimeoutInMinutes": null,
        "managedOutboundIPs": {
          "count": 1,
          "countIpv6": null
        },
        "outboundIPs": null,
        "outboundIpPrefixes": null
      },
      "loadBalancerSku": "standard",
      "natGatewayProfile": null,
      "networkDataplane": "azure",
      "networkMode": null,
      "networkPlugin": "azure",
      "networkPluginMode": null,
      "networkPolicy": "none",
      "outboundType": "loadBalancer",
      "podCidr": null,
      "podCidrs": null,
      "podLinkLocalAccess": "IMDS",
      "serviceCidr": "10.0.0.0/16",
      "serviceCidrs": [
        "10.0.0.0/16"
      ],
      "staticEgressGatewayProfile": null
    },
    "apiServerAccess": {
      "authorizedIpRanges": null,
      "disableRunCommand": null,
      "enablePrivateCluster": true,
      "enablePrivateClusterPublicFqdn": true,
      "enableVnetIntegration": null,
      "privateDnsZone": "system",
      "subnetId": null
    }
  },
  "networking": {
    "vnets": [
      {
        "name": "aks-vnet",
        "resourceGroup": "vnet-api-connection-lab1-rg",
        "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet",
        "addressSpace": [
          "10.2.0.0/16"
        ],
        "subnets": [],
        "peerings": [
          {
            "name": "aks-to-dns",
            "remoteVirtualNetwork": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/dnsserver-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/dnsVnet",
            "peeringState": "Connected",
            "allowVirtualNetworkAccess": true,
            "allowForwardedTraffic": true,
            "allowGatewayTransit": false,
            "useRemoteGateways": false
          }
        ]
      }
    ],
    "outbound": {
      "type": "loadBalancer",
      "configuredPublicIPs": [
        "4.174.255.41"
      ],
      "effectiveOutbound": {
        "mechanism": "loadBalancer",
        "overridden_by_udr": false,
        "effective_mechanism": "loadBalancer",
        "virtual_appliance_ips": [],
        "load_balancer_ips": [
          "4.174.255.41"
        ],
        "warnings": [],
        "description": "Traffic uses Load Balancer with public IP(s): 4.174.255.41"
      },
      "udrAnalysis": null
    },
    "privateDns": {
      "type": "system",
      "privateDnsZone": "system",
      "analysis": "System-managed private DNS zone"
    },
    "apiServerAccess": {
      "privateCluster": true,
      "authorizedIpRanges": null,
      "disableRunCommand": null,
      "analysis": {
        "ipRangeRestriction": "none"
      },
      "securityFindings": [],
      "accessRestrictions": {
        "model": "private",
        "description": "Private cluster - API server only accessible from VNet",
        "implications": [
          "\u2705 API server is isolated from the internet",
          "\u2705 Access only from resources within the VNet or peered networks",
          "\ud83d\udcdd Requires VPN or ExpressRoute for external access",
          "\ud83d\udcdd Private DNS zone required for name resolution"
        ]
      }
    },
    "vmssConfiguration": [
      {
        "name": "aks-nodepool1-41624625-vmss",
        "resourceGroup": "MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral",
        "networkProfile": {
          "healthProbe": null,
          "networkApiVersion": null,
          "networkInterfaceConfigurations": [
            {
              "auxiliaryMode": null,
              "auxiliarySku": null,
              "deleteOption": null,
              "disableTcpStateTracking": false,
              "dnsSettings": {
                "dnsServers": []
              },
              "enableAcceleratedNetworking": false,
              "enableFpga": null,
              "enableIpForwarding": false,
              "ipConfigurations": [
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": [
                    {
                      "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral/providers/Microsoft.Network/loadBalancers/kubernetes/backendAddressPools/aksOutboundBackendPool",
                      "resourceGroup": "MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral"
                    },
                    {
                      "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral/providers/Microsoft.Network/loadBalancers/kubernetes/backendAddressPools/kubernetes",
                      "resourceGroup": "MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral"
                    }
                  ],
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig1",
                  "primary": true,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig2",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig3",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig4",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig5",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig6",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig7",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig8",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig9",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig10",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig11",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig12",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig13",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig14",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig15",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig16",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig17",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig18",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig19",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig20",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig21",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig22",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig23",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig24",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig25",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig26",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig27",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig28",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                },
                {
                  "applicationGatewayBackendAddressPools": null,
                  "applicationSecurityGroups": null,
                  "loadBalancerBackendAddressPools": null,
                  "loadBalancerInboundNatPools": null,
                  "name": "ipconfig29",
                  "primary": null,
                  "privateIpAddressVersion": "IPv4",
                  "publicIpAddressConfiguration": null,
                  "subnet": {
                    "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
                    "resourceGroup": "vnet-api-connection-lab1-rg"
                  }
                }
              ],
              "name": "aks-nodepool1-41624625-vmss",
              "networkSecurityGroup": {
                "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral/providers/Microsoft.Network/networkSecurityGroups/aks-agentpool-34331157-nsg",
                "resourceGroup": "MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral"
              },
              "primary": true
            }
          ]
        }
      }
    ],
    "nsgConfiguration": {
      "subnetNsgs": [
        {
          "subnetId": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/virtualNetworks/aks-vnet/subnets/aks-subnet",
          "subnetName": "aks-subnet",
          "nsgId": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/networkSecurityGroups/aks-vnet-aks-subnet-nsg-canadacentral",
          "nsgName": "aks-vnet-aks-subnet-nsg-canadacentral",
          "rules": [],
          "defaultRules": [
            {
              "access": "Allow",
              "description": "Allow inbound traffic from all VMs in VNET",
              "destinationAddressPrefix": "VirtualNetwork",
              "destinationAddressPrefixes": [],
              "destinationPortRange": "*",
              "destinationPortRanges": [],
              "direction": "Inbound",
              "etag": "W/\"3d5dffba-2d94-480a-b323-15db751fee36\"",
              "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/networkSecurityGroups/aks-vnet-aks-subnet-nsg-canadacentral/defaultSecurityRules/AllowVnetInBound",
              "name": "AllowVnetInBound",
              "priority": 65000,
              "protocol": "*",
              "provisioningState": "Succeeded",
              "resourceGroup": "vnet-api-connection-lab1-rg",
              "sourceAddressPrefix": "VirtualNetwork",
              "sourceAddressPrefixes": [],
              "sourcePortRange": "*",
              "sourcePortRanges": [],
              "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
            },
            {
              "access": "Allow",
              "description": "Allow inbound traffic from azure load balancer",
              "destinationAddressPrefix": "*",
              "destinationAddressPrefixes": [],
              "destinationPortRange": "*",
              "destinationPortRanges": [],
              "direction": "Inbound",
              "etag": "W/\"3d5dffba-2d94-480a-b323-15db751fee36\"",
              "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/networkSecurityGroups/aks-vnet-aks-subnet-nsg-canadacentral/defaultSecurityRules/AllowAzureLoadBalancerInBound",
              "name": "AllowAzureLoadBalancerInBound",
              "priority": 65001,
              "protocol": "*",
              "provisioningState": "Succeeded",
              "resourceGroup": "vnet-api-connection-lab1-rg",
              "sourceAddressPrefix": "AzureLoadBalancer",
              "sourceAddressPrefixes": [],
              "sourcePortRange": "*",
              "sourcePortRanges": [],
              "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
            },
            {
              "access": "Deny",
              "description": "Deny all inbound traffic",
              "destinationAddressPrefix": "*",
              "destinationAddressPrefixes": [],
              "destinationPortRange": "*",
              "destinationPortRanges": [],
              "direction": "Inbound",
              "etag": "W/\"3d5dffba-2d94-480a-b323-15db751fee36\"",
              "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/networkSecurityGroups/aks-vnet-aks-subnet-nsg-canadacentral/defaultSecurityRules/DenyAllInBound",
              "name": "DenyAllInBound",
              "priority": 65500,
              "protocol": "*",
              "provisioningState": "Succeeded",
              "resourceGroup": "vnet-api-connection-lab1-rg",
              "sourceAddressPrefix": "*",
              "sourceAddressPrefixes": [],
              "sourcePortRange": "*",
              "sourcePortRanges": [],
              "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
            },
            {
              "access": "Allow",
              "description": "Allow outbound traffic from all VMs to all VMs in VNET",
              "destinationAddressPrefix": "VirtualNetwork",
              "destinationAddressPrefixes": [],
              "destinationPortRange": "*",
              "destinationPortRanges": [],
              "direction": "Outbound",
              "etag": "W/\"3d5dffba-2d94-480a-b323-15db751fee36\"",
              "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/networkSecurityGroups/aks-vnet-aks-subnet-nsg-canadacentral/defaultSecurityRules/AllowVnetOutBound",
              "name": "AllowVnetOutBound",
              "priority": 65000,
              "protocol": "*",
              "provisioningState": "Succeeded",
              "resourceGroup": "vnet-api-connection-lab1-rg",
              "sourceAddressPrefix": "VirtualNetwork",
              "sourceAddressPrefixes": [],
              "sourcePortRange": "*",
              "sourcePortRanges": [],
              "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
            },
            {
              "access": "Allow",
              "description": "Allow outbound traffic from all VMs to Internet",
              "destinationAddressPrefix": "Internet",
              "destinationAddressPrefixes": [],
              "destinationPortRange": "*",
              "destinationPortRanges": [],
              "direction": "Outbound",
              "etag": "W/\"3d5dffba-2d94-480a-b323-15db751fee36\"",
              "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/networkSecurityGroups/aks-vnet-aks-subnet-nsg-canadacentral/defaultSecurityRules/AllowInternetOutBound",
              "name": "AllowInternetOutBound",
              "priority": 65001,
              "protocol": "*",
              "provisioningState": "Succeeded",
              "resourceGroup": "vnet-api-connection-lab1-rg",
              "sourceAddressPrefix": "*",
              "sourceAddressPrefixes": [],
              "sourcePortRange": "*",
              "sourcePortRanges": [],
              "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
            },
            {
              "access": "Deny",
              "description": "Deny all outbound traffic",
              "destinationAddressPrefix": "*",
              "destinationAddressPrefixes": [],
              "destinationPortRange": "*",
              "destinationPortRanges": [],
              "direction": "Outbound",
              "etag": "W/\"3d5dffba-2d94-480a-b323-15db751fee36\"",
              "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/vnet-api-connection-lab1-rg/providers/Microsoft.Network/networkSecurityGroups/aks-vnet-aks-subnet-nsg-canadacentral/defaultSecurityRules/DenyAllOutBound",
              "name": "DenyAllOutBound",
              "priority": 65500,
              "protocol": "*",
              "provisioningState": "Succeeded",
              "resourceGroup": "vnet-api-connection-lab1-rg",
              "sourceAddressPrefix": "*",
              "sourceAddressPrefixes": [],
              "sourcePortRange": "*",
              "sourcePortRanges": [],
              "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
            }
          ]
        }
      ],
      "nicNsgs": [
        {
          "vmssName": "aks-nodepool1-41624625-vmss",
          "nicName": "aks-nodepool1-41624625-vmss",
          "nsgId": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral/providers/Microsoft.Network/networkSecurityGroups/aks-agentpool-34331157-nsg",
          "nsgName": "aks-agentpool-34331157-nsg",
          "rules": [],
          "defaultRules": [
            {
              "access": "Allow",
              "description": "Allow inbound traffic from all VMs in VNET",
              "destinationAddressPrefix": "VirtualNetwork",
              "destinationAddressPrefixes": [],
              "destinationPortRange": "*",
              "destinationPortRanges": [],
              "direction": "Inbound",
              "etag": "W/\"8fa24b86-6737-468e-a20b-bcb682e543e6\"",
              "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral/providers/Microsoft.Network/networkSecurityGroups/aks-agentpool-34331157-nsg/defaultSecurityRules/AllowVnetInBound",
              "name": "AllowVnetInBound",
              "priority": 65000,
              "protocol": "*",
              "provisioningState": "Succeeded",
              "resourceGroup": "MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral",
              "sourceAddressPrefix": "VirtualNetwork",
              "sourceAddressPrefixes": [],
              "sourcePortRange": "*",
              "sourcePortRanges": [],
              "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
            },
            {
              "access": "Allow",
              "description": "Allow inbound traffic from azure load balancer",
              "destinationAddressPrefix": "*",
              "destinationAddressPrefixes": [],
              "destinationPortRange": "*",
              "destinationPortRanges": [],
              "direction": "Inbound",
              "etag": "W/\"8fa24b86-6737-468e-a20b-bcb682e543e6\"",
              "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral/providers/Microsoft.Network/networkSecurityGroups/aks-agentpool-34331157-nsg/defaultSecurityRules/AllowAzureLoadBalancerInBound",
              "name": "AllowAzureLoadBalancerInBound",
              "priority": 65001,
              "protocol": "*",
              "provisioningState": "Succeeded",
              "resourceGroup": "MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral",
              "sourceAddressPrefix": "AzureLoadBalancer",
              "sourceAddressPrefixes": [],
              "sourcePortRange": "*",
              "sourcePortRanges": [],
              "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
            },
            {
              "access": "Deny",
              "description": "Deny all inbound traffic",
              "destinationAddressPrefix": "*",
              "destinationAddressPrefixes": [],
              "destinationPortRange": "*",
              "destinationPortRanges": [],
              "direction": "Inbound",
              "etag": "W/\"8fa24b86-6737-468e-a20b-bcb682e543e6\"",
              "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral/providers/Microsoft.Network/networkSecurityGroups/aks-agentpool-34331157-nsg/defaultSecurityRules/DenyAllInBound",
              "name": "DenyAllInBound",
              "priority": 65500,
              "protocol": "*",
              "provisioningState": "Succeeded",
              "resourceGroup": "MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral",
              "sourceAddressPrefix": "*",
              "sourceAddressPrefixes": [],
              "sourcePortRange": "*",
              "sourcePortRanges": [],
              "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
            },
            {
              "access": "Allow",
              "description": "Allow outbound traffic from all VMs to all VMs in VNET",
              "destinationAddressPrefix": "VirtualNetwork",
              "destinationAddressPrefixes": [],
              "destinationPortRange": "*",
              "destinationPortRanges": [],
              "direction": "Outbound",
              "etag": "W/\"8fa24b86-6737-468e-a20b-bcb682e543e6\"",
              "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral/providers/Microsoft.Network/networkSecurityGroups/aks-agentpool-34331157-nsg/defaultSecurityRules/AllowVnetOutBound",
              "name": "AllowVnetOutBound",
              "priority": 65000,
              "protocol": "*",
              "provisioningState": "Succeeded",
              "resourceGroup": "MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral",
              "sourceAddressPrefix": "VirtualNetwork",
              "sourceAddressPrefixes": [],
              "sourcePortRange": "*",
              "sourcePortRanges": [],
              "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
            },
            {
              "access": "Allow",
              "description": "Allow outbound traffic from all VMs to Internet",
              "destinationAddressPrefix": "Internet",
              "destinationAddressPrefixes": [],
              "destinationPortRange": "*",
              "destinationPortRanges": [],
              "direction": "Outbound",
              "etag": "W/\"8fa24b86-6737-468e-a20b-bcb682e543e6\"",
              "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral/providers/Microsoft.Network/networkSecurityGroups/aks-agentpool-34331157-nsg/defaultSecurityRules/AllowInternetOutBound",
              "name": "AllowInternetOutBound",
              "priority": 65001,
              "protocol": "*",
              "provisioningState": "Succeeded",
              "resourceGroup": "MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral",
              "sourceAddressPrefix": "*",
              "sourceAddressPrefixes": [],
              "sourcePortRange": "*",
              "sourcePortRanges": [],
              "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
            },
            {
              "access": "Deny",
              "description": "Deny all outbound traffic",
              "destinationAddressPrefix": "*",
              "destinationAddressPrefixes": [],
              "destinationPortRange": "*",
              "destinationPortRanges": [],
              "direction": "Outbound",
              "etag": "W/\"8fa24b86-6737-468e-a20b-bcb682e543e6\"",
              "id": "/subscriptions/18fcfcaf-51b0-42c1-91ba-b14fe22f59dd/resourceGroups/MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral/providers/Microsoft.Network/networkSecurityGroups/aks-agentpool-34331157-nsg/defaultSecurityRules/DenyAllOutBound",
              "name": "DenyAllOutBound",
              "priority": 65500,
              "protocol": "*",
              "provisioningState": "Succeeded",
              "resourceGroup": "MC_aks-api-connection-lab1-rg_aks-api-connection_canadacentral",
              "sourceAddressPrefix": "*",
              "sourceAddressPrefixes": [],
              "sourcePortRange": "*",
              "sourcePortRanges": [],
              "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules"
            }
          ]
        }
      ],
      "requiredRules": {
        "outbound": [
          {
            "name": "AKS_Registry_Access",
            "protocol": "TCP",
            "destination": "MicrosoftContainerRegistry",
            "ports": [
              "443"
            ],
            "description": "Access to Microsoft Container Registry"
          },
          {
            "name": "AKS_Azure_Management",
            "protocol": "TCP",
            "destination": "AzureCloud",
            "ports": [
              "443"
            ],
            "description": "Azure management endpoints"
          },
          {
            "name": "AKS_DNS",
            "protocol": "UDP",
            "destination": "*",
            "ports": [
              "53"
            ],
            "description": "DNS resolution"
          },
          {
            "name": "AKS_NTP",
            "protocol": "UDP",
            "destination": "*",
            "ports": [
              "123"
            ],
            "description": "Network Time Protocol"
          }
        ],
        "inbound": [
          {
            "name": "AKS_Inter_Node_Communication",
            "protocol": "*",
            "source": "VirtualNetwork",
            "ports": [
              "*"
            ],
            "description": "Communication between cluster nodes"
          },
          {
            "name": "AKS_Load_Balancer",
            "protocol": "*",
            "source": "AzureLoadBalancer",
            "ports": [
              "*"
            ],
            "description": "Azure Load Balancer health probes"
          }
        ]
      },
      "missingRules": [],
      "blockingRules": [],
      "interNodeCommunication": {
        "status": "ok",
        "issues": []
      }
    },
    "routingAnalysis": {
      "outboundType": "loadBalancer",
      "udrAnalysis": null
    }
  },
  "diagnostics": {
    "apiConnectivityProbe": {
      "enabled": true,
      "tests": [
        {
          "status": "passed",
          "output": "Server: 10.1.0.10\\nAddress: 10.1.0.10#53 Non-authoritative answer:\\nmcr.microsoft.com canonical name = mcr.trafficmanager.net.\\nmcr.trafficmanager.net canonical name = mcr-0001.mcr-msedge.net.\\nName: mcr-0001.mcr-msedge.net\\nAddress: 150.171.69.10\\nName: mcr-0001.mcr-msedge.net\\nAddress: 150.171.70.10\\nName: mcr-0001.mcr-msedge.net\\nAddress: 2603:1061:f:100::10\\nName: mcr-0001.mcr-msedge.net\\nAddress: 2603:1061:f:101::10",
          "stderr": "",
          "error": "",
          "execution_time": 0,
          "exit_code": 0,
          "vmss_name": "aks-nodepool1-41624625-vmss",
          "instance_id": "0",
          "test_name": "DNS Resolution - Microsoft Container Registry"
        },
        {
          "status": "passed",
          "output": "{}",
          "stderr": "Time Time Time Current\\n Dload Upload Total Spent Left Speed\\n 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0* Trying 150.171.70.10:443...\\n* Connected to mcr.microsoft.com (150.171.70.10) port 443 (#0)\\n* ALPN, offering h2\\n* ALPN, offering http/1.1\\n* TLSv1.0 (OUT), TLS header, Certificate Status (22):\\n} [5 bytes data]\\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\\n} [512 bytes data]\\n* TLSv1.2 (IN), TLS header, Certificate Status (22):\\n{ [5 bytes data]\\n* TLSv1.3 (IN), TLS handshake, Server hello (2):\\n{ [88 bytes data]\\n* TLSv1.2 (OUT), TLS header, Finished (20):\\n} [5 bytes data]\\n* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):\\n} [1 bytes data]\\n* TLSv1.2 (OUT), TLS header, Certificate Status (22):\\n} [5 bytes data]\\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\\n} [512 bytes data]\\n* TLSv1.2 (IN), TLS header, Finished (20):\\n{ [5 bytes data]\\n* TLSv1.2 (IN), TLS header, Certificate Status (22):\\n{ [5 bytes data]\\n* TLSv1.3 (IN), TLS handshake, Server hello (2):\\n{ [223 bytes data]\\n* TLSv1.2 (IN), TLS header, Supplemental data (23):\\n{ [5 bytes data]\\n* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):\\n{ [19 bytes data]\\n* TLSv1.3 (IN), TLS handshake, Certificate (11):\\n{ [3628 bytes data]\\n* TLSv1.3 (IN), TLS handshake, CERT verify (15):\\n{ [264 bytes data]\\n* TLSv1.3 (IN), TLS handshake, Finished (20):\\n{ [52 bytes data]\\n* TLSv1.2 (OUT), TLS header, Supplemental data (23):\\n} [5 bytes data]\\n* TLSv1.3 (OUT), TLS handshake, Finished (20):\\n} [52 bytes data]\\n* SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384\\n* ALPN, server accepted to use h2\\n* Server certificate:\\n* subject: C=US; ST=WA; L=Redmond; O=Microsoft Corporation; CN=mcr.microsoft.com\\n* start date: Aug 23 17:41:17 2025 GMT\\n* expire date: Feb 19 17:41:17 2026 GMT\\n* issuer: C=US; O=Microsoft Corporation; CN=Microsoft Azure RSA TLS Issuing CA 07\\n* SSL certificate verify result: unable to get local issuer certificate (20), continuing anyway.\\n* Using HTTP2, server supports multiplexing\\n* Connection state changed (HTTP/2 confirmed)\\n* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0\\n* TLSv1.2 (OUT), TLS header, Supplemental data (23):\\n} [5 bytes data]\\n* TLSv1.2 (OUT), TLS header, Supplemental data (23):\\n} [5 bytes data]\\n* TLSv1.2 (OUT), TLS header, Supplemental data (23):\\n} [5 bytes data]\\n* Using Stream ID: 1 (easy handle 0x55e3b8aa19f0)\\n* TLSv1.2 (OUT), TLS header, Supplemental data (23):\\n} [5 bytes data]\\n> GET /v2/ HTTP/2\\n> Host: mcr.microsoft.com\\n> user-agent: curl/7.81.0\\n> accept: */*\\n> \\n* TLSv1.2 (IN), TLS header, Supplemental data (23):\\n{ [5 bytes data]\\n* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):\\n{ [437 bytes data]\\n* TLSv1.2 (IN), TLS header, Supplemental data (23):\\n{ [5 bytes data]\\n* TLSv1.2 (OUT), TLS header, Supplemental data (23):\\n} [5 bytes data]\\n* TLSv1.2 (IN), TLS header, Supplemental data (23):\\n{ [5 bytes data]\\n* TLSv1.2 (IN), TLS header, Supplemental data (23):\\n{ [5 bytes data]\\n< HTTP/2 200 \\n< content-length: 2\\n< content-type: application/json; charset=utf-8\\n< access-control-expose-headers: Docker-Content-Digest\\n< access-control-expose-headers: WWW-Authenticate\\n< access-control-expose-headers: Link\\n< access-control-expose-headers: X-Ms-Correlation-Request-Id\\n< docker-distribution-api-version: registry/2.0\\n< strict-transport-security: max-age=31536000; includeSubDomains\\n< x-content-type-options: nosniff\\n< x-ms-correlation-request-id: af1c9a88-b324-4aec-8d53-162df97841b5\\n< strict-transport-security: max-age=31536000; includeSubDomains\\n< x-cache: CONFIG_NOCACHE\\n< x-mcr-env: prod\\n< x-mcr-privacy: https://privacy.microsoft.com/en-us/privacystatement\\n< x-msedge-ref: Ref A: EC55019F64D440589757A43AE33E6A6B Ref B: YTO221090812031 Ref C: 2025-09-12T19:19:11Z\\n< date: Fri, 12 Sep 2025 19:19:11 GMT\\n< \\n{ [2 bytes data]\\n* TLSv1.2 (IN), TLS header, Supplemental data (23):\\n{ [5 bytes data]\\n100 2 100 2 0 0 25 0 --:--:-- --:--:-- --:--:-- 25\\n* Connection #0 to host mcr.microsoft.com left intact",
          "error": "",
          "execution_time": 0,
          "exit_code": 0,
          "vmss_name": "aks-nodepool1-41624625-vmss",
          "instance_id": "0",
          "test_name": "HTTPS Connectivity - Microsoft Container Registry"
        },
        {
          "status": "passed",
          "output": "Server: 10.1.0.10\\nAddress: 10.1.0.10#53 Non-authoritative answer:\\nmanagement.azure.com canonical name = management.privatelink.azure.com.\\nmanagement.privatelink.azure.com canonical name = arm-frontdoor-edge-geo.trafficmanager.net.\\narm-frontdoor-edge-geo.trafficmanager.net canonical name = edge-management-azure-com.arm-0001.arm-msedge.net.\\nedge-management-azure-com.arm-0001.arm-msedge.net canonical name = arm-0001.arm-msedge.net.\\nName: arm-0001.arm-msedge.net\\nAddress: 4.150.240.10\\nName: arm-0001.arm-msedge.net\\nAddress: 2603:1030:a0b::10",
          "stderr": "",
          "error": "",
          "execution_time": 0,
          "exit_code": 0,
          "vmss_name": "aks-nodepool1-41624625-vmss",
          "instance_id": "0",
          "test_name": "DNS Resolution - Azure Management"
        },
        {
          "status": "passed",
          "output": "{\"error\":{\"code\":\"MissingApiVersionParameter\",\"message\":\"The api-version query parameter (?api-version=) is required for all requests.\"}}",
          "stderr": "% Total % Received % Xferd Average Speed Time Time Time Current\\n Dload Upload Total Spent Left Speed\\n 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0* Trying 4.150.240.10:443...\\n* Connected to management.azure.com (4.150.240.10) port 443 (#0)\\n* ALPN, offering h2\\n* ALPN, offering http/1.1\\n* TLSv1.0 (OUT), TLS header, Certificate Status (22):\\n} [5 bytes data]\\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\\n} [512 bytes data]\\n* TLSv1.2 (IN), TLS header, Certificate Status (22):\\n{ [5 bytes data]\\n* TLSv1.3 (IN), TLS handshake, Server hello (2):\\n{ [88 bytes data]\\n* TLSv1.2 (OUT), TLS header, Finished (20):\\n} [5 bytes data]\\n* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):\\n} [1 bytes data]\\n* TLSv1.2 (OUT), TLS header, Certificate Status (22):\\n} [5 bytes data]\\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\\n} [512 bytes data]\\n* TLSv1.2 (IN), TLS header, Finished (20):\\n{ [5 bytes data]\\n* TLSv1.2 (IN), TLS header, Certificate Status (22):\\n{ [5 bytes data]\\n* TLSv1.3 (IN), TLS handshake, Server hello (2):\\n{ [223 bytes data]\\n* TLSv1.2 (IN), TLS header, Supplemental data (23):\\n{ [5 bytes data]\\n* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):\\n{ [19 bytes data]\\n* TLSv1.3 (IN), TLS handshake, Certificate (11):\\n{ [3691 bytes data]\\n* TLSv1.3 (IN), TLS handshake, CERT verify (15):\\n{ [264 bytes data]\\n* TLSv1.3 (IN), TLS handshake, Finished (20):\\n{ [52 bytes data]\\n* TLSv1.2 (OUT), TLS header, Supplemental data (23):\\n} [5 bytes data]\\n* TLSv1.3 (OUT), TLS handshake, Finished (20):\\n} [52 bytes data]\\n* SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384\\n* ALPN, server accepted to use h2\\n* Server certificate:\\n* subject: C=US; ST=WA; L=Redmond; O=Microsoft Corporation; CN=edge.management.azure.com\\n* start date: Aug 27 00:44:00 2025 GMT\\n* expire date: Feb 23 00:44:00 2026 GMT\\n* issuer: C=US; O=Microsoft Corporation; CN=Microsoft Azure RSA TLS Issuing CA 03\\n* SSL certificate verify result: unable to get local issuer certificate (20), continuing anyway.\\n* Using HTTP2, server supports multiplexing\\n* Connection state changed (HTTP/2 confirmed)\\n* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0\\n* TLSv1.2 (OUT), TLS header, Supplemental data (23):\\n} [5 bytes data]\\n* TLSv1.2 (OUT), TLS header, Supplemental data (23):\\n} [5 bytes data]\\n* TLSv1.2 (OUT), TLS header, Supplemental data (23):\\n} [5 bytes data]\\n* Using Stream ID: 1 (easy handle 0x5576cd5ee9f0)\\n* TLSv1.2 (OUT), TLS header, Supplemental data (23):\\n} [5 bytes data]\\n> GET / HTTP/2\\n> Host: management.azure.com\\n> user-agent: curl/7.81.0\\n> accept: */*\\n> \\n* TLSv1.2 (IN), TLS header, Supplemental data (23):\\n{ [5 bytes data]\\n* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):\\n{ [437 bytes data]\\n* TLSv1.2 (IN), TLS header, Supplemental data (23):\\n{ [5 bytes data]\\n* TLSv1.2 (OUT), TLS header, Supplemental data (23):\\n} [5 bytes data]\\n* TLSv1.2 (IN), TLS header, Supplemental data (23):\\n{ [5 bytes data]\\n* TLSv1.2 (IN), TLS header, Supplemental data (23):\\n{ [5 bytes data]\\n< HTTP/2 400 \\n< cache-control: no-cache\\n< pragma: no-cache\\n< content-length: 137\\n< content-type: application/json; charset=utf-8\\n< expires: -1\\n< x-ms-failure-cause: gateway\\n< x-ms-request-id: d8ce45c6-092c-4df2-8beb-5b39a239c9e3\\n< x-ms-correlation-request-id: d8ce45c6-092c-4df2-8beb-5b39a239c9e3\\n< x-ms-routing-request-id: CANADACENTRAL:20250912T192017Z:d8ce45c6-092c-4df2-8beb-5b39a239c9e3\\n< strict-transport-security: max-age=31536000; includeSubDomains\\n< x-content-type-options: nosniff\\n< x-cache: CONFIG_NOCACHE\\n< x-msedge-ref: Ref A: 3ED3838D01B141E183868CFAB065445A Ref B: YTO221090814009 Ref C: 2025-09-12T19:20:17Z\\n< date: Fri, 12 Sep 2025 19:20:17 GMT\\n< \\n{ [137 bytes data]\\n* TLSv1.2 (IN), TLS header, Supplemental data (23):\\n{ [5 bytes data]\\n100 137 100 137 0 0 2952 0 --:--:-- --:--:-- --:--:-- 2978\\n* Connection #0 to host management.azure.com left intact",
          "error": "",
          "execution_time": 0,
          "exit_code": 0,
          "vmss_name": "aks-nodepool1-41624625-vmss",
          "instance_id": "0",
          "test_name": "HTTPS Connectivity - Azure Management"
        },
        {
          "status": "failed",
          "output": "Server: 10.1.0.10\\nAddress: 10.1.0.10#53 ** server can't find aks-api-connection-arxthi8q.e04358b2-6d06-4895-b09b-b1575d934e69.privatelink.canadacentral.azmk8s.io: NXDOMAIN",
          "stderr": "",
          "error": "DNS resolved to public IP instead of private IP. Private DNS zone link may be missing or misconfigured.",
          "execution_time": 0,
          "exit_code": 0,
          "vmss_name": "aks-nodepool1-41624625-vmss",
          "instance_id": "0",
          "test_name": "DNS Resolution - API Server (Private)"
        },
        {
          "test_name": "API Server Connectivity - https://aks-api-connection-arxthi8q.e04358b2-6d06-4895-b09b-b1575d934e69.privatelink.canadacentral.azmk8s.io",
          "vmss_name": "aks-nodepool1-41624625-vmss",
          "instance_id": "0",
          "status": "skipped",
          "exit_code": -1,
          "output": "",
          "stderr": "",
          "error": "Skipped due to DNS resolution failure for API Server",
          "execution_time": 0,
          "analysis": "Test skipped because DNS resolution for API Server failed"
        }
      ],
      "summary": {
        "total_tests": 5,
        "passed": 4,
        "failed": 1,
        "errors": 0
      }
    },
    "failureAnalysis": {
      "enabled": false
    },
    "findings": [
      {
        "severity": "critical",
        "code": "CLUSTER_OPERATION_FAILURE",
        "message": "Cluster failed with error: VMExtensionProvisioningError: CSE failed with 'VMExtensionError_K8SAPIServerDNSLookupFail', which means agents are unable to resolve Kubernetes API server name. It's likely custom DNS server is not correctly configured, please see https://aka.ms/aks/vmextensionerror_k8sapiserverdnslookupfail and https://aka.ms/aks/private-cluster#hub-and-spoke-with-custom-dns for more information.",
        "error_code": "VMExtensionProvisioningError",
        "recommendation": "Check Azure Activity Log for detailed failure information and contact Azure support if needed"
      },
      {
        "severity": "critical",
        "code": "NODE_POOL_FAILURE",
        "message": "Node pools in failed state: nodepool1",
        "recommendation": "Check node pool configuration and Azure Activity Log for detailed failure information"
      },
      {
        "severity": "critical",
        "code": "PDNS_DNS_HOST_VNET_LINK_MISSING",
        "message": "DNS server 10.1.0.10 is hosted in VNet dnsVnet but this VNet is not linked to private DNS zone e04358b2-6d06-4895-b09b-b1575d934e69.privatelink.canadacentral.azmk8s.io. Cluster VNet aks-vnet uses this DNS server.",
        "recommendation": "Link VNet dnsVnet to private DNS zone e04358b2-6d06-4895-b09b-b1575d934e69.privatelink.canadacentral.azmk8s.io to ensure proper DNS resolution for the private cluster"
      },
      {
        "severity": "error",
        "code": "CONNECTIVITY_DNS_FAILURE",
        "message": "DNS resolution tests failed: DNS Resolution - API Server (Private)",
        "recommendation": "Check DNS server configuration and network connectivity. Verify custom DNS servers are accessible and properly configured."
      },
      {
        "severity": "critical",
        "code": "CONNECTIVITY_API_SERVER_FAILURE",
        "message": "API server connectivity test failed from cluster nodes",
        "recommendation": "Check private DNS configuration, VNet links, and API server access policies. For private clusters, ensure DNS resolution is working correctly."
      }
    ]
  }
}